{% extends "web/app/project_base.html" %}
{% load static %}

{% block app-class%}workflow-detail{% endblock %}

{% block app %}

<div class="workflow-detail__header">
  <h3 class="mr-auto">{{ object.name }}</h3>

  <turbo-frame id="workflows:run" src="{% url 'workflows:run' object.id %}"></turbo-frame>
  <a class="button button--square button--sm button--filled"
     href="{% url 'projects:workflows:update' project.id object.pk %}">Update</a>
  <a class="button button--square button--sm button--filled button--pink"
     href="{% url 'projects:workflows:delete' project.id object.pk %}">Delete</a>
</div>

<div data-controller="tf-modal url-search-params" class="flex flex-1">
  <div data-tf-modal-target="modal" class="hidden fixed h-full w-full p-24 z-10">
    <div class="bg-white">
      <button 
        data-controller="url-search-params"
        data-url-search-params-key-value="node_id"
        data-action="click->tf-modal#close click->url-search-params#remove">
        Close
      </button>
      <turbo-frame id="workflow-node" data-tf-modal-target="turboFrame"></turbo-frame> 
    </div>
  </div>  

  <div id="react-app" class="flex-auto"></div>
</div>

{{ nodes|json_script:'nodes' }}

<script src="{% static 'rest_framework/js/coreapi-0.1.1.js' %}"></script>
<script src="{% url 'api_schemajs' %}"></script>
<script src="{% static 'js/workflow-bundle.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/workflow.css' %}" />
{% endblock %}
