{% extends "web/app/project_base.html" %}
{% load static %}

{% block app-class%}workflow-detail{% endblock %}

{% block app %}
<div class="workflow-detail__header">
  <form method="post" action="{% url 'projects:workflows:detail' project.id object.id %}" class="form">
    {% csrf_token %}

    <input class='input__inline' id="name" type="text" name="name" value="{{ object.name }}"></input>

  </form>
  <div data-controller='event-refresh' data-event-refresh-event-value='workflow-run' class='mr-auto'>
    <turbo-frame id="workflow-last-run" src="{% url 'workflows:last_run' object.id %}"
                 data-event-refresh-target="turboFrame">
    </turbo-frame>
  </div>
  <a class="button button--circle button--tertiary" href="{% url 'projects:workflows:delete' project.id object.pk %}">
    <i class="far fa-fw fa-trash"></i>
  </a>
</div>

<div data-controller="tf-modal" class="flex flex-1 overflow-hidden">
  <div data-tf-modal-target="modal" class="tf-modal hidden">
    <div class="card card--inline w-full flex-col h-full relative">
      <div class="absolute top-0 right-0">
        <button class="tf-modal__close px-4 py-3" data-action="click->tf-modal#close">
          <i class="fal fa-times fa-2x"></i>
        </button>
      </div>

      <turbo-frame id="workflow-node" data-tf-modal-target="turboFrame"></turbo-frame>
    </div>
  </div>

  <div id="react-app" class="flex-auto"></div>
</div>
{{ nodes|json_script:'nodes' }}

<script src="{% static 'js/workflow-bundle.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/workflow.css' %}" />
{% endblock %}
