{% extends "web/base.html" %}
{% load static %}
{% load team_tags %}

{% firstof team project.team as team %}

{% block banner %}
  {% if team and team.warning %}
  <div class="banner banner--warning">
    <p>
      You're exceeding your row count limit.
      <a
        href="{% url 'teams:account' team.id %}"
        class="text-white font-bold underline"
      >
        Learn more <i class="fas fa-fw fa-arrow-right fa-sm"></i>
      </a>
    </p>
  </div>
  {% endif %}

  {% if team and not team.enabled %}
  <div class="banner banner--danger">
    <p>
      You've exceeded your row count limit by over 20%, your team is
      temporarily disabled.
      <a
        href="{% url 'teams:account' team.id %}"
        class="text-white font-bold underline"
      >
        Learn more <i class="fas fa-fw fa-arrow-right fa-sm"></i>
      </a>
    </p>
  </div>
  {% endif %}
{% endblock %}

{% block team_sidebar %}
  {% include "web/components/team_sidebar.html" %}
{% endblock %}

{% block sidebar_content %}
<a
  id="heading"
  href=""
  class="sidebar__link sidebar__link--border"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  {% if team.icon %}
  <img src="{{ team.icon.url }}" />
  {% else %}
  <span class="team_logo">
    {{ team.name|slice:1 }}
  </span>
  {% endif %}

  <strong class="h3">
    {{ team.name }}
  </strong>

  <span data-tooltip-target="body">{{ team.name }}</span>
</a>

<a
  class="sidebar__link {% if request.resolver_match.url_name == 'detail' %}sidebar__link--active{% endif %}"
  href="{% url 'teams:detail' team.id %}"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  <i class="far fa-fw fa-folders"></i>Projects

  <span data-tooltip-target="body">Projects</span>
</a>

{% if request.user|is_admin_of:team %}
<a
  class="sidebar__link {% if request.resolver_match.url_name == 'list' %}sidebar__link--active{% endif %}"
  href="{% url 'team_members:list' team.id %}"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  <i class="far fa-fw fa-users"></i>Members

  <span data-tooltip-target="body">Members</span>
</a>

<a
  class="sidebar__link {% if request.resolver_match.url_name in 'account,subscription,plan,payments' %}sidebar__link--active{% endif %}"
  href="{% url 'teams:account' team.id %}"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  <i class="far fa-fw fa-wallet"></i>Billing

  <span data-tooltip-target="body">Billing</span>
</a>

<a
  class="sidebar__link {% if request.resolver_match.app_name == 'team_flags' %}sidebar__link--active{% endif %}"
  href="{% url 'team_flags:team' team.id %}"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  <i class="fas fa-fw fa-flask"></i>Beta

  <span data-tooltip-target="body">Beta</span>
</a>

<a
  class="sidebar__link {% if request.resolver_match.url_name == 'update' %}sidebar__link--active{% endif %}"
  href="{% url 'teams:update' team.id %}"
  data-controller="tooltip"
  data-tooltip-placement="right"
  data-show-on-collapse="true"
>
  <i class="far fa-fw fa-cog"></i>Settings

  <span data-tooltip-target="body">Settings</span>
</a>
{% endif %}
{% endblock %}

{% block body %}
  {% block notifications %}{% endblock %}

  <section class="flex flex-col flex-1 overflow-hidden {% block app-class %}{% endblock %}">
    {% block app %}{% endblock %}
  </section>
{% endblock body %}
