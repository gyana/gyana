{% extends "web/base.html" %}
{% load static %}

{% block banner %}
  {% if project.team.warning %}
    <div class="banner banner--warning">
      <p>
        You're exceeding your row count limit.
        <a href="{% url 'teams:account' project.team.id %}" class="text-white font-bold underline"> Learn more <span aria-hidden="true">&rarr;</span></a>
      </p>
    </div>
  {% endif %}

  {% if not project.team.enabled %}
    <div class="banner banner--danger">
      <p>
        You've exceeded your row count limit by over 20%, your team is
        temporarily disabled. <a href="{% url 'teams:account' project.team.id %}" class="text-white font-bold underline"> Learn more <span aria-hidden="true">&rarr;</span></a>
      </p>
    </div>
  {% endif %}
{% endblock %}

{% block sidebar_content %}
<a class="sidebar__link sidebar__link--border" href="{% url 'teams:detail' project.team.id %}">
  {% if project.team.icon %}<img src="{{ project.team.icon.url }}" />{% else %}<span class="team_logo">{{ project.team.name|slice:1 }}</span>{% endif %}
  <strong class="h3">
    {{ project.team.name }}
  </strong>
</a>

<style>
  .sidebar__title div {
    font-size: 0;
  }

  .sidebar__title div:first-letter {
    font-size: 1.8rem;
  }

  .sidebar__title div::after {
    content: '.';
    font-size: 1.8rem;
    display: inline-block;
  }
</style>
<a
  class="sidebar__title"
  title="{{ project.name }}"
  href="{% url 'projects:detail' project.id %}"
>
  <div>{{ project.name }}</div>
</a>

{% with app_name=request.resolver_match.app_name %}

{% if project.ready %}
<li>
  <a class="sidebar__link {% if app_name == 'projects' and request.resolver_match.url_name == 'detail' %}sidebar__link--active{% endif %}"
    href="{% url 'projects:detail' project.id %}"
    data-controller="tooltip"
    data-placement="right">
    <i class="far fa-fw fa-home mr-6"></i>Overview
    <span data-tooltip-target="body">Overview</span>
  </a>
</li>

<li>
  <a class="sidebar__link {% if app_name == "project_integrations" %}sidebar__link--active{% endif %}"
    href="{% url 'project_integrations:list' project.id %}"
    data-controller="tooltip"
    data-placement="right">
    <i class="far fa-fw fa-database mr-6"></i>Integrations {% if project.integrations_for_review > 0 %}({{ project.integrations_for_review }}){% endif %}
    <span data-tooltip-target="body">Integrations</span>
  </a>
</li>

<li class="sidebar__bar"></li>

<li>
  <a class="sidebar__link {% if app_name == "project_workflows" %}sidebar__link--active{% endif %}"
    href="{% url 'project_workflows:list' project.id %}"
    data-controller="tooltip"
    data-placement="right">
    <i class="far fa-fw fa-sitemap mr-6"></i>Workflows
    <span data-tooltip-target="body">Workflows</span>
  </a>
</li>

<li class="sidebar__bar"></li>

<li>
  <a class="sidebar__link {% if app_name == "project_dashboards" or app_name == "dashboard_widgets" %}sidebar__link--active{% endif %}"
    href="{% url 'project_dashboards:list' project.id %}"
    data-controller="tooltip"
    data-placement="right">
    <i class="far fa-fw fa-chart-pie mr-6"></i>Dashboards
    <span data-tooltip-target="body">Dashboards</span>
  </a>
</li>
{% endif %}

{% if not project.ready %}
<li>
  <a class="sidebar__link {% if app_name == 'project_templateinstances' %}sidebar__link--active{% endif %}"
    href="{% url 'project_templateinstances:list' project.id %}"
    data-controller="tooltip"
    data-placement="right">
    <i class="far fa-fw fa-construction mr-6"></i>Templates
    <span data-tooltip-target="body">Templates</span>
  </a>
</li>
{% endif %}

<li>
  <a class="sidebar__link {% if app_name == "projects" and request.resolver_match.url_name == 'update' %}sidebar__link--active{% endif %}"
     href="{% url 'projects:update' project.id %}"
     data-controller="tooltip"
     data-placement="right">
    <i class="far fa-fw fa-cog mr-6"></i>Settings
    <span data-tooltip-target="body">Settings</span>
  </a>
</li>
{% endwith %}
{% endblock %}

{% block body %}

{% block notifications %}{% endblock %}

<section
  class="project"
  data-controller="dropzone"
  data-sheets-url="{% url 'project_integrations_sheets:create' project.id %}"
>
  <section class="flex flex-col flex-1 overflow-hidden {% block app-class %}{% endblock %}">
    {% block app %}{% endblock %}
  </section>
</section>
{% endblock body %}
