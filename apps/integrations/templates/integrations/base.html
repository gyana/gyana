{% extends "web/app/project_base.html" %}
{% load static %}

{% block app %}
<div class="workflow-detail__header">
  <h3 class="mr-auto flex justify-center items-center">
    <img class="h-12 w-12 mr-4" src="{% static integration.icon %}" title="{{ integration.name }}" />
    <turbo-frame id="integration-name">
      <form method="post" action="{% url 'project_integrations:detail' project.id object.id %}" class="form">
        {% csrf_token %}

        <input class='input__inline' id="name" type="text" name="name" value="{{ object.name }}"></input>
      </form>
    </turbo-frame>
  </h3>

  {% if integration.kind == "sheet" %}
  <a
    href="{{ integration.sheet.url }}"
    class="button button--circle button--tertiary"
    target="_blank"
    rel="noopener noreferer"
    title="External source link"
  >
    <i class="fas fa-link fa-sm mr-1"></i>
  </a>
  {% endif %}
</div>

<nav id='tabbar' class="tabbar">
  {% if integration.ready %}
    <a class="tabbar__link {% if request.resolver_match.url_name == 'detail' %} tabbar__link--active {% endif %}"
      href="{% url 'project_integrations:detail' project.id integration.id %}">
      Overview
    </a>
    <a class="tabbar__link {% if request.resolver_match.url_name == 'data' %} tabbar__link--active {% endif %}"
      href="{% url 'project_integrations:data' project.id integration.id %}">
      Data
    </a>
  {% endif %}
  {% comment %} Uploads cannot be setup again after approval {% endcomment %}
  {% if not integration.ready or integration.kind != integration.Kind.UPLOAD %}
    <a class="tabbar__link {% if request.resolver_match.url_name in 'update,load,done,setup' %} tabbar__link--active {% endif %}"
      href="{% url 'project_integrations:setup' project.id integration.id %}">
      Setup
    </a>
  {% endif %}
  <a class="tabbar__link {% if request.resolver_match.url_name == 'settings' %} tabbar__link--active {% endif %}"
    href="{% url 'project_integrations:settings' project.id integration.id %}">
    Settings
  </a>
</nav>

{% block extra_tab %}{% endblock %}

<div id='main' class="flex flex-col flex-1 overflow-auto">
  {% block tab %}{% endblock %}
</div>
{% endblock %}
