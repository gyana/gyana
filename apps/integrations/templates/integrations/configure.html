{% extends 'integrations/base_setup.html' %}

{% block tab %}

<div class="pad flex flex-1 justify-center items-center">
  <div class='flex flex-col flex-1 max-w-3xl'>
    <h1 class="flex items-center justify-center gap-3 mb-7">Configure import</h1>
    <div class="flex flex-1 justify-center items-center">

      <form 
        id="configure-update-form"
        method="POST"
        action="{{ request.get_full_path }}"
        {% if object.kind == 'customapi' or request.GET.tab == 'custom_reports' %}
        data-controller="live-update"
        data-action="
          formset:remove->live-update#updateForm 
          formset:add->live-update#updateForm 
          formset:remove->tf-modal#change 
          formset:add->tf-modal#change
        "
        enctype='multipart/form-data'
        {% endif %}
        >
        <span data-live-update-target="loading" class="hidden">
          <i class="placeholder-scr__icon fad fa-spinner-third fa-spin fa-fw fa-2x"></i>
        </span>

        <p class="alert">
          If you're not sure about these options, you can start with the defaults and tweak them later.
          {% if object.kind == 'connector' %}
            You can also go back to the <a href="{{ object.connector.fivetran_authorization_url }}" class="link">authorization</a> page.
          {% endif %}
        </p>

        {% if object.kind == 'connector' %}
          <div class="tabbar w-full">
            <a
              href="{% url "project_integrations:configure" project.id object.id %}?tab=tables"
              class="tabbar__link {% if not request.GET.tab or request.GET.tab == 'tables' %}tabbar__link--active{% endif %}"
            >
              Tables
            </a>
            {% if object.connector.service == 'facebook_ads' %}
              <a
                href="{% url "project_integrations:configure" project.id object.id %}?tab=prebuilt_reports"
                class="tabbar__link {% if request.GET.tab == 'prebuilt_reports' %}tabbar__link--active{% endif %}"
              >
                Prebuilt Reports
              </a>
              <a
                href="{% url "project_integrations:configure" project.id object.id %}?tab=custom_reports"
                class="tabbar__link {% if request.GET.tab == 'custom_reports' %}tabbar__link--active{% endif %}"
              >
                Custom Reports
              </a>
            {% endif %}
          </div>
        {% endif %}

        {% csrf_token %}

        {% if request.GET.tab == 'tables' %}
          <p>A table is a list of records in your data source e.g. products or ads.</p>
          <p class="alert mb-4">
            For a faster initial sync and optimized row usage, only select the tables you need.
          </p>
        {% elif request.GET.tab == 'prebuilt_reports' %}
          <p>A prebuilt report is a frequently used template for a reporting source.</p>
          <p class="alert mb-4">
            Pre-built reports are a great way to get familiar with a data source, before you start to build custom reports.
          </p>
        {% elif request.GET.tab == 'custom_reports' %}
          <p>A custom report is a fully customised request to a reporting source.</p>
          <p class="alert mb-4">
            Take time to understand the options available to build an effective report.
          </p>
        {% endif %}

        {% include "django/forms/default_form.html" %}

        <div class="flex flex-1 gap-7 w-full">
          <button type="submit" name="submit" value="Save" class="button button--outline button--success flex-1">
            Save
          </button>

          <button type="submit" name="submit" value="Save & Import" class="button button--success flex-1">
            Save & Import
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}
