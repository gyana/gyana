{% extends "web/app/app_base.html" %}
{% load static %}

{% block app %}
<div class="workflow-detail__header">
  <h2>{{ template.name }}</h2>

  <div class="flex gap-7 ml-auto">
    <a class="button button--sm button--tertiary" href="{% url 'teams:detail' team.id %}">Go back</a>

    <form method="post">
      {% csrf_token %}

      {% include "django/forms/default_form.html" %}

      <button type="submit" class="button button--sm">Use this template</button>
    </form>
  </div>
</div>

<div class="flex items-center gap-4 border-b border-gray pad">
<p class="mr-auto">{{ template.description }}</p>
  {% for integration in template.project.integration_set.all %}
    <div data-controller="tooltip">
      <img class="h-12 w-12" src="{% static integration.icon %}" title="{{ integration.name }}" />
      <span data-tooltip-target="body">{{ integration.display_kind }}</span>
    </div>
  {% endfor %}
</div>

{% with request.GET.dashboard_id|default:template.project.dashboard_set.first.id|add:"0" as dashboard_id %}
  {% if template.project.dashboard_set.count > 1 %}
  <nav id='tabbar' class="tabbar">
    {% for dashboard in template.project.dashboard_set.all %}
    <a class="tabbar__link {% if dashboard.id == dashboard_id %} tabbar__link--active {% endif %}"
      href="?dashboard_id={{ dashboard.id }}">
      {{ dashboard.name }}
    </a>
    {% endfor %}
  </nav>
  {% endif %}
  <div class="flex flex-1 pad flex-col items-center overflow-auto">
    <div class="card card--sm">
      <turbo-frame id="dashboard:preview" src="{% url 'dashboards:preview' dashboard_id %}">
        <div class='placeholder-scr placeholder-scr--fillscreen'>
          <i class="placeholder-scr__icon fad fa-spinner-third fa-spin"></i>
          <p class='placeholder-scr__title'>Loading preview...</p>
        </div>
      </turbo-frame>
    </div>
  </div>
{% endwith %}

{% endblock %} 
