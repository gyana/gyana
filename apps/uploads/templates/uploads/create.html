{% extends "projects/settings_base.html" %}
{% load static %}
{% load help_utils %}

{% block app %}
  <div class="page-header">
    <h1 class="flex items-center gap-3 mr-auto">
      CSV Upload

      {% link_article 'integrations' 'upload' %}
      {% link_video 'upload' %}
    </h1>
  </div>

  <div class="upload-csv">
    <form
      id="create-form"
      method="POST"
      action="{{ request.get_full_path }}"
      class="upload-csv__form dropzone"
      enctype="multipart/form-data"
      style="background: none; border: none;"
    >
      <div class="hidden">
        {% csrf_token %}

        {{ form }}
      </div>
    </form>
  </div>

  {{ form.media.js }}

  <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />

  <script type="text/javascript">

    window.Dropzone.options.createForm = {
      dictDefaultMessage: `<div>
        <span>Drop files or click here to upload<span>
        <p class="input__help-text">Maximum upload size is 1GB</p>
      </div>`,
      maxFiles: 1,
      maxFilesize: window.__cypressMaxSize__ || 1000,
      acceptedFiles: '.csv, .tsv, text/csv, text/plain',
      success: function(file) {
        window.location.href = file.xhr.responseURL
      }
    };
  </script>

{% endblock %}
