{% extends "web/app/app_base.html" %}
{% load humanize %}

{% block app-class%}project-list{% endblock %}

{% block app %}

<div class="flex items-center mb-4">
  <h1 class="mr-auto">Projects</h1>
  <a class="button button--filled button--sm ml-4" href="{% url 'team_projects:create' team.slug %}">
    <i class="fas fa-fw fa-plus"></i> New Project
  </a>
</div>

<div class="flex justify-start items-start gap-7">
  <ul class="project-list__projects">
    {% for object in object_list %}
    <li>
      <div class="card card--custom">
        <div class="flex flex-col justify-between pad">
          <a href="{% url 'projects:detail' object.pk %}" class="h3">{{ object }}</a>

          <div class="flex-1">
            <span>Created {{ object.created|naturaltime }} | </span>
            <span>Updated {{ object.updated|naturaltime }}</span>
          </div>
        </div>

        <hr>

        <div class="tabbar tabbar--full tabbar--sm">
          <a href="{% url 'project_integrations:list' object.id %}"
             class="tabbar__link flex-1">{{ object.integration_count }}
            Integration{{ object.integration_count|pluralize }}</a>
          <a href="{% url 'project_workflows:list' object.id %}" class="tabbar__link flex-1">{{ object.workflow_count }}
            Workflow{{ object.workflow_count|pluralize }}</a>
          <a href="{% url 'project_dashboards:list' object.id %}"
             class="tabbar__link flex-1">{{ object.dashboard_count }}
            Dashboard{{ object.dashboard_count|pluralize }}</a>
        </div>
      </div>
    </li>
    {% empty %}
    <li>
      <div class="card">
        <h3>No projects found</h3>
        <p>Why not create one one using the button in the top right corner?</p>
      </div>
    </li>
    {% endfor %}
  </ul>

  <div class="flex flex-col gap-7">
    <div class="card card--center flex-col">
      <h3>{{ team.sorted_memberships|length }}</h3>
      <p>Team member{{ team.sorted_memberships|length|pluralize }}</p>
    </div>
    <div class="card card--center flex-col">
      <h3>{{ team.sorted_memberships|length }}</h3>
      <p>Team member{{ team.sorted_memberships|length|pluralize }}</p>
    </div>
    <div class="card card--center flex-col">
      <h3>{{ team.sorted_memberships|length }}</h3>
      <p>Team member{{ team.sorted_memberships|length|pluralize }}</p>
    </div>
  </div>

</div>

{% if is_paginated %}
<div class="pagination">
  <span class="page-links">
    {% if page_obj.has_previous %}
    <a href="{% url 'team_projects:list' team.slug %}?page={{ page_obj.previous_page_number }}">previous</a>
    {% endif %}
    <span class="page-current">
      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
    </span>
    {% if page_obj.has_next %}
    <a href="{% url 'team_projects:list' team.slug %}?page={{ page_obj.next_page_number }}">next</a>
    {% endif %}
  </span>
</div>
{% endif %} {% endblock %}
