{% extends "web/app/project_base.html" %}
{% load render_table from django_tables2 %}
{% load humanize %}

{% block app %}

<header class="page-header">
  <div class="mr-auto">
    <h1>{{ project.name }}</h1>

    {% if project.description %}
    <p>{{ project.description }}</p>
    {% endif %}
  </div>
</header>

<div class="flex flex-col flex-1 gap-7 pad">
  <div class="flex flex-col gap-7 flex-1">
    <div class="flex flex-wrap gap-7">
      <div class="flex-1">
        <div class="flex mb-3">
          <h3>Recent Integrations</h3>
        </div>

        <div class="card card--none flex-1">
          {% render_table integrations %}

          {% if integrations.rows|length == 0 %}
          <div class="table__empty">
            <h3>Step 1</h3>
            <p>
              <a href="{% url 'project_integrations_uploads:upload' project.id %}" class="link">Upload a CSV</a>, or
              <a href="{% url 'project_integrations:new' project.id %}" class="link">create an integration</a>
            </p>
          </div>
          {% endif %}
        </div>
      </div>

      <div class="flex-1">
        <div class="flex mb-3">
          <h3>Recent Workflows</h3>
        </div>

        <div class="card card--none flex-1">
          {% render_table workflows %}

          {% if workflows.rows|length == 0 %}
          <div class="table__empty">
            <h3>Step 2</h3>
            <form class="inline"
                  method="post"
                  action="{% url 'project_workflows:create' project.id  %}">
              {% csrf_token %}
              <input type="hidden" name="project" value="{{ project.id }}"></input>
              <p>
                Use your data to
                <button type="submit" class="link">
                  create a workflow
                </button>
              </p>
            </form>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div>
      <div class="flex mb-3">
        <h3>Recent Dashboards</h3>
      </div>

      <div class="card card--none flex-1">
        {% render_table dashboards %}

        {% if dashboards.rows|length == 0 %}
        <div class="table__empty">
          <h3>Step 3</h3>
          <form class="inline"
                method="post"
                action="{% url 'project_dashboards:create' project.id %}?mode=edit">
            {% csrf_token %}
            <input type="hidden" name="project" value="{{ project.id }}"></input>
            <p>
              Visualise all your data
              <button type="submit" class="link">
                in a dashboard
              </button>
            </p>
          </form>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
