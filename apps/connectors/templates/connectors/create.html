{% extends "web/app/project_settings_base.html" %}
{% load static %}

{% block app %}

<div class="flex flex-row flex-1 overflow-hidden">
  <div class='flex flex-col flex-1 overflow-auto'>
    <h2 class="pad">Create a new connector</h2>

    {% if request.GET.service %}
    <div class='flex flex-col flex-1'>
      <div class="pad" id='create-container'>
        <form id="create-form" method="post" action="{{ request.get_full_path }}" class="form max-w-xl" data-turbo="false">
          {% csrf_token %}

          {% include "django/forms/default_form.html" %}

        <p>You will now be redirected to Fivetran to setup your integration.</p>

          <button type="submit" class="button button--success">
            Continue
          </button>
        </form>
      </div>
    {% else %}
    <div class='flex flex-col flex-1'>  
        <div class="flex flex-wrap gap-16 pad">
            {% for category in service_categories %}
            <div class="flex flex-col gap-7">
                <h3>{{ category|capfirst }}</h3>
                <div class="flex flex-1 flex-wrap content-start gap-7">
                {% for service_id, service in services.items %}
                    {% if service.type == category %}
                      {% if service.internal != 't' or request.user.is_superuser %}
                        <a class="card card--inline card--square"
                          href="{% url 'project_integrations_connectors:create' project.id %}?service={{ service_id }}">
                          <div class="flex-1">
                              <img style="height:4.2rem;" src="{% static 'images/integrations/fivetran/'|add:service.icon_path %}"
                                  alt="{{ service.name }}" />
                          </div>
                          <span class="flex-1">{{ service.name }}</span>
                        </a>
                      {% endif %}
                    {% endif %}
                {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
      </div> 
    {% endif %}
    </div>
  </div>
  {% if request.GET.service %}
    <div class='flex flex-shrink-0 h-full'>
      {% include 'connectors/_guide.html' with service=services|dict_key:request.GET.service %}
    </div>
  {% endif %}
</div>

{% endblock %}
